package osv

// https://github.com/ossf/osv-schema/blob/v1.5.0/docs/schema.md
// https://github.com/golang/vulndb/blob/294a5723ad93ece970b2837b08812c42743c6c31/internal/osv/osv.go

const SchemaVersion = "v1.5.0"

type Entry struct {
	// SchemaVersion is used to indicate which version of the OSV schema a particular vulnerability was exported with.
	SchemaVersion string `json:"schema_version,omitempty"`
	// ID is a unique identifier for the vulnerability. Required.
	// It's same as CVE ID, if there's no CVE ID, using GHSA or other ID.
	ID string `json:"id"`
	// Modified is the time the entry was last modified. Required.
	Modified *Time `json:"modified,omitempty"`
	// Published is the time the entry should be considered to have been published.
	Published *Time `json:"published,omitempty"`
	// Withdrawn is the time the entry should be considered to have been withdrawn.
	// If the field is missing, then the entry has not been withdrawn.
	Withdrawn *Time `json:"withdrawn,omitempty"`
	// Aliases is a list of IDs for the same vulnerability in other databases.
	Aliases []string `json:"aliases,omitempty"`
	// Related field gives a list of IDs of closely related vulnerabilities, such as the same problem in alternate ecosystems.
	Related []string `json:"related,omitempty"`
	// Summary contains a one-line, English textual summary of the vulnerability.
	Summary string `json:"summary,omitempty"`
	// Details contains English textual details about the vulnerability.
	Details string `json:"details"`
	// Severity is a JSON array that allows generating systems
	// to describe the severity of a vulnerability using one or more quantitative scoring methods.
	Severity []Severity `json:"severity,omitempty"`
	// Affected contains information on the modules and versions affected by the vulnerability.
	Affected []Affected `json:"affected"`
	// References field contains a list of JSON objects describing references.
	References []Reference `json:"references,omitempty"`
	// Credits field is a JSON array providing a way to give credit for the discovery, confirmation, patch,
	// or other events in the life cycle of a vulnerability.
	Credits          []Credit  `json:"credits,omitempty"`
	DatabaseSpecific *Specific `json:"database_specific,omitempty"`
}
