package osv

import (
	"github.com/ssst0n3/vulnerability-research-database/model/osv/type/env"
)

type Specific struct {
	// SummaryZH contains a one-line, Chinese-Simplified textual summary of the vulnerability.
	SummaryZH string `json:"summary_zh,omitempty"`
	// DetailsZH contains Chinese-Simplified textual details about the vulnerability.
	DetailsZH string      `json:"details_zh,omitempty"`
	Analyses  []Analysis  `json:"analyses,omitempty"`
	Reproduce Environment `json:"reproduce,omitempty"`
	Exploits  []Exploit   `json:"exploits,omitempty"`
	Tags      []Tag       `json:"tags"`
	ProjectID uint        `json:"project_id"`
	Project   Project     `json:"project" gorm:"foreignKey:ProjectID"`
	// references from github.com/ssst0n3/researcher-tracer
	ResearcherID uint `json:"researcher_id"`
}

type Environment struct {
	Credits []Credit `json:"credits"`
	Type    env.Type `json:"type"`
	Image   string   `json:"image"`
	Usage   string   `json:"usage"`
	Url     string   `json:"url"`
}

type Analysis struct {
	Credits []Credit `json:"credits"`
	Version string   `json:"version"`
	Url     string   `json:"url"`
}

type Exploit struct {
	Credits []Credit `json:"credit"`
	Url     string   `json:"url"`
}

type Tag struct {
	Name string `json:"name"`
}

type Project struct {
	Name     string `json:"name"`
	Homepage string `json:"homepage"`
}
