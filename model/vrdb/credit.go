package vrdb

import (
	"github.com/ssst0n3/vulnerability-research-database/model/osv"
	"gorm.io/gorm"
)

type Credit struct {
	gorm.Model
	osv.Credit
	Vulnerabilities []Vulnerability `json:"vulnerabilities" gorm:"many2many:vulnerability_credits;"`
}

func (c Credit) OSV() *osv.Credit {
	return &c.Credit
}

func NewCredit(o osv.Credit) *Credit {
	return &Credit{
		Credit: o,
	}
}
func NewCredits(o []osv.Credit) (credits []Credit) {
	for _, credit := range o {
		credits = append(credits, *NewCredit(credit))
	}
	return
}
