package vrdb

import (
	"database/sql/driver"
	"encoding/json"
	"github.com/ssst0n3/vulnerability-research-database/model/osv"
)

type Strings []string

func (t *Strings) Value() (driver.Value, error) { return json.Marshal(*t) }
func (t *Strings) Scan(value interface{}) error { return json.Unmarshal(value.([]byte), t) }

type Severities []osv.Severity

func (t *Severities) Value() (driver.Value, error) { return json.Marshal(*t) }
func (t *Severities) Scan(value interface{}) error { return json.Unmarshal(value.([]byte), t) }

type Affects []osv.Affected

func (t *Affects) Value() (driver.Value, error) { return json.Marshal(*t) }
func (t *Affects) Scan(value interface{}) error { return json.Unmarshal(value.([]byte), t) }

type References []osv.Reference

func (t *References) Value() (driver.Value, error) { return json.Marshal(*t) }
func (t *References) Scan(value interface{}) error { return json.Unmarshal(value.([]byte), t) }
