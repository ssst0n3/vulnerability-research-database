package vrdb

import (
	"github.com/ssst0n3/awesome_libs/awesome_error"
	"github.com/ssst0n3/lightweight_api"
	"github.com/ssst0n3/vulnerability-research-database/model/osv"
	"gorm.io/gorm"
	"gorm.io/gorm/schema"
)

type Tag struct {
	gorm.Model
	osv.Tag
	Vulnerabilities []Vulnerability `json:"vulnerabilities" gorm:"many2many:vulnerability_tags;"`
}

var SchemaTag schema.Schema

func init() {
	awesome_error.CheckFatal(lightweight_api.InitSchema(&SchemaTag, &Tag{}))
}

func NewTag(o osv.Tag) *Tag {
	return &Tag{
		Tag: o,
	}
}
func NewTags(o []osv.Tag) (tags []Tag) {
	for _, tag := range o {
		tags = append(tags, *NewTag(tag))
	}
	return
}
